import type { KnownBlock, Block } from '@slack/bolt';
import type { MessageType } from './types.js';

/**
 * ?????????????
 */

/**
 * ??????????????????
 */
export function getHomeTabBlocks(userId: string): KnownBlock[] {
  return [
    {
      type: 'section',
      text: {
        type: 'mrkdwn',
        text: '*?????Slack Bot???????*\n\n??????????Slack Bot?????????????',
      },
    },
    {
      type: 'divider',
    },
    {
      type: 'section',
      text: {
        type: 'mrkdwn',
        text: '*??????????*\n? `/hello` - ??????????\n? `/echo [????]` - ?????????\n? `/help` - ???????????\n? `/demo` - ??????????????',
      },
    },
    {
      type: 'divider',
    },
    {
      type: 'section',
      text: {
        type: 'mrkdwn',
        text: '*???????????*\n? ??????????????????????????\n? ??????????????????????????',
      },
    },
  ];
}

/**
 * ??????????
 */
export function getHelloMessage(userId: string): string {
  return `??????<@${userId}>?????\n?????????????`;
}

/**
 * ???????????
 */
export function getEchoMessage(text: string | undefined): string {
  return `???: ${text || '????????????'}`;
}

/**
 * ???????????
 */
export function getHelpMessage(): string {
  return `*Slack Bot????? - ???*\n\n*??????????*\n? \`/hello\` - ?????????????\n? \`/echo [????]\` - ???????????????\n? \`/help\` - ????????????????\n? \`/demo\` - ????????????????????\n\n*?????????*\n? ??????????????????????\n? ??????????????????????\n? ?????????????????`;
}

/**
 * ???????????????
 */
export function getDemoBlocks(): Block[] {
  return [
    {
      type: 'section',
      text: {
        type: 'mrkdwn',
        text: '?????????????????',
      },
    },
    {
      type: 'actions',
      elements: [
        {
          type: 'button',
          text: {
            type: 'plain_text',
            text: '?? ???',
          },
          action_id: 'button_click',
          value: 'good',
          style: 'primary',
        },
        {
          type: 'button',
          text: {
            type: 'plain_text',
            text: '?? ????',
          },
          action_id: 'button_click',
          value: 'bad',
          style: 'danger',
        },
      ],
    },
  ];
}

/**
 * ?????????????????
 */
export function getButtonResponseMessage(value: string): string {
  if (value === 'good') {
    return '????????????? ??????????????????';
  } else if (value === 'bad') {
    return '??????????????????????????????\n?????????????????????????????';
  }
  return '???????????';
}

/**
 * ???????????????
 */
export function getMentionResponseMessage(userId: string, type: MessageType): string {
  switch (type) {
    case 'greeting':
      return `??????<@${userId}>?????????????????????`;
    case 'thanks':
      return `?????????<@${userId}>???`;
    case 'time':
      const now = new Date();
      return `?????? ${now.toLocaleString('ja-JP')} ???`;
    default:
      return `<@${userId}>?????????????????????`;
  }
}
